<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>My App Redirect</title>

<script>
// --- CONFIGURE YOUR LINKS HERE ---
const LINKS = {
  ios: "https://apps.apple.com/us/app/duas-and-aamal/id6478907381",
  android: "https://play.google.com/store/apps/details?id=app.duasandaamal.com&hl=en",
  desktop: "google.com?query=duas+and+aamal+app",
};

// detect platform
function getPlatform() {
  const ua = navigator.userAgent || navigator.vendor || window.opera;
  if (/android/i.test(ua)) return "android";
  if (/iPad|iPhone|iPod/.test(ua) && !window.MSStream) return "ios";
  return "desktop";
}

// collect utm params from current URL
function getUtmParams() {
  const params = new URLSearchParams(window.location.search);
  const utms = {};
  params.forEach((v, k) => {
    if (k.startsWith("utm_")) utms[k] = v;
  });
  return utms;
}

// append UTM params to link
function appendUtms(url, utms) {
  if (!utms || Object.keys(utms).length === 0) return url;
  const u = new URL(url);
  for (const [k, v] of Object.entries(utms)) {
    u.searchParams.set(k, v);
  }
  return u.toString();
}

// redirect logic
function redirect() {
  const platform = getPlatform();
  const utms = getUtmParams();
  const target = LINKS[platform] || LINKS.desktop;

  const finalUrl = appendUtms(target, utms);

  document.getElementById("status").textContent = `Redirecting to ${platform}...`;
  setTimeout(() => { window.location.href = finalUrl; }, 800);
}

window.addEventListener("DOMContentLoaded", redirect);
</script>

<style>
body {
  font-family: system-ui, -apple-system, sans-serif;
  background: #f7f7f7;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  color: #333;
}
.box {
  background: #fff;
  padding: 30px;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  text-align: center;
  width: 320px;
}
h1 {
  font-size: 20px;
  margin-bottom: 10px;
}
p {
  font-size: 14px;
  color: #666;
}
</style>
</head>

<body>
  <div class="box">
    <h1>Opening My App</h1>
    <p id="status">Detecting your device...</p>
    <p>If youâ€™re not redirected automatically, <a id="manual-link" href="#">click here</a>.</p>
  </div>
<script>
document.getElementById("manual-link").addEventListener("click", e => {
  e.preventDefault();
  redirect();
});
</script>
</body>
</html>
